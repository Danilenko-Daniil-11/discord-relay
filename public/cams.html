<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Камеры ПК</title>
</head>
<body>
<h1>Выберите ПК</h1>
<select id="pcSelect"></select>
<canvas id="videoCanvas" width="640" height="480" style="border:1px solid #000;"></canvas>

<script>
const pcSelect = document.getElementById('pcSelect');
const canvas = document.getElementById('videoCanvas');
const ctx = canvas.getContext('2d');

let ws;

function connectToPC(pcId){
    if(ws) ws.close();
    ws = new WebSocket(`ws://${location.host}/?pcId=${pcId}`);
    ws.onmessage = e=>{
        const img = new Image();
        img.src = 'data:image/jpeg;base64,' + e.data;
        img.onload = ()=>ctx.drawImage(img,0,0,canvas.width,canvas.height);
    };
}

// TODO: динамически заполнять список ПК
// Для примера можно вручную добавить
const pcs = ["ПК_1","ПК_2"];
pcs.forEach(pc=>{
    const opt = document.createElement("option");
    opt.value = pc;
    opt.textContent = pc;
    pcSelect.appendChild(opt);
});

pcSelect.addEventListener("change", ()=>connectToPC(pcSelect.value));
connectToPC(pcSelect.value);
</script>
</body>
</html>
