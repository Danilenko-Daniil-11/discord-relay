<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Камеры ПК</title>
</head>
<body>
<h1>Онлайн камеры ПК</h1>
<select id="pcSelect"></select>
<br><br>
<img id="camView" width="640" height="480" style="border:1px solid #000">

<script>
let ws;
const select = document.getElementById('pcSelect');
const img = document.getElementById('camView');

async function updatePCList(){
    const res = await fetch('/api/online-pcs'); // нужно создать эндпоинт для списка
    const pcs = await res.json();
    select.innerHTML = pcs.map(pc => `<option value="${pc}">${pc}</option>`).join('');
    if(pcs.length>0) connectWS(pcs[0]);
}

function connectWS(pcId){
    if(ws) ws.close();
    ws = new WebSocket(`ws://${location.host}?pcId=${encodeURIComponent(pcId)}`);
    ws.onmessage = e => {
        img.src = "data:image/jpeg;base64," + e.data;
    };
}

select.addEventListener('change', e => connectWS(e.target.value));

updatePCList();
setInterval(updatePCList, 10000); // обновляем список каждые 10 сек
</script>
</body>
</html>
